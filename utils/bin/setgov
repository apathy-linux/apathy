#!/mss/bin/sh
. /mss/files/funcs

case "${1}" in
 c)
  aprint_nc
  read govcurrent < /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
  lsdetail "current" "${govcurrent}"
  aprint_nc

  exit 0
 ;;
 *)
  rootcheck

  read availgov < /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_governors
   govlist="$(echo "${availgov}" | sed 's/ /\n/g')"
  govlines="$(echo "${govlist}"  | wc -l)"
  govapply="$(echo "${govlist}"  | slmenu -b -l "${govlines}" -p "pick the governor.")"

  aprint "setting the cpu governor to ${cb_grn}${govapply}${c_res}."
  aprint_nc

  for i in /sys/devices/system/cpu/*/cpufreq/scaling_governor; do
   echo "${govapply}" > "${i}"
  done

  exit 0
 ;;
esac
